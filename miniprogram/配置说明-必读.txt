====================================
  腾讯地图API配置说明（必读）
====================================

为了显示详细的上车地点地址（如：xx大厦、xx街道等），需要配置腾讯地图API服务。

✅ 已集成：腾讯地图微信小程序JavaScript SDK
✅ 已配置：API Key (2W6BZ-Z7KEW-T3BRI-YEZHB-OXGGE-ONFZR)

====================================
  第一步：申请腾讯地图API Key
====================================

1. 访问腾讯位置服务官网：
   https://lbs.qq.com/

2. 点击右上角"控制台"，使用QQ或微信登录

3. 创建应用：
   - 点击"应用管理" → "我的应用" → "创建应用"
   - 应用名称：填写您的小程序名称
   - 应用类型：选择"微信小程序"

4. 添加Key：
   - 在应用管理中点击"添加Key"
   - Key名称：随意填写
   - Key类型：选择"WebServiceAPI"
   - 点击"提交"
   - 复制生成的Key（类似：OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77）

5. 配置Key：✅ 已完成
   您的Key：2W6BZ-Z7KEW-T3BRI-YEZHB-OXGGE-ONFZR
   已配置到：miniprogram/utils/map-config.js

====================================
  第二步：配置服务器域名白名单 ⚠️ 重要！
====================================

⚠️ 必须完成以下任一配置，否则会一直卡在"正在获取位置..."：

方案A：开发调试阶段（推荐，立即生效）
  1. 打开微信开发者工具
  2. 点击右上角"详情"→"本地设置"
  3. 勾选"不校验合法域名、web-view（业务域名）、TLS版本以及HTTPS证书"
  4. 重新编译小程序

方案B：正式发布配置（正式上线必须）
  1. 登录微信公众平台：https://mp.weixin.qq.com/
  2. 进入您的小程序管理后台
  3. 开发 → 开发管理 → 开发设置 → 服务器域名
  4. 在"request合法域名"中添加：
     https://apis.map.qq.com
  5. 点击"保存并提交"
  
注意：每月只能修改5次服务器域名，请谨慎操作

====================================
  第三步：测试功能
====================================

1. 重新编译小程序
2. 允许获取位置权限
3. 等待定位成功
4. 上车地点应该显示详细地址，例如：
   - "xx科技大厦"
   - "xx路xx号"
   - "xx区xx街道xx小区"
   等具体地址信息

====================================
  费用说明
====================================

腾讯地图提供的免费额度：
  - 逆地理编码：每天10,000次免费调用
  - 对于个人小程序或中小型应用完全够用
  - 超出免费额度后才会收费

====================================
  常见问题
====================================

Q1: 提示"请先配置腾讯地图API Key"？
A: 请检查 miniprogram/utils/map-config.js 文件，确保已替换Key

Q2: 显示"当前位置"而不是详细地址？
A: 可能原因：
   - Key未配置或配置错误
   - 未在开发者工具勾选"不校验合法域名"
   - 网络请求失败
   - Key配额用完

Q3: 如何查看错误信息？
A: 打开微信开发者工具的"调试器"→"Console"，查看错误日志

Q4: 不想申请Key可以吗？
A: 不申请Key的话，上车地点会显示"当前位置"，无法显示详细地址

====================================
  技术细节
====================================

✅ 已集成功能：
1. 腾讯地图微信小程序JavaScript SDK
   文件：miniprogram/utils/qqmap-wx-jssdk.js
2. SDK初始化和调用
   文件：miniprogram/pages/index/index.js

功能实现原理：
1. 获取用户GPS经纬度（gcj02坐标系）
2. 使用SDK调用腾讯地图逆地理编码API (reverseGeocoder)
3. 返回详细地址信息（优先返回POI建筑物名称）
4. 更新界面显示

API文档：
- SDK文档：https://lbs.qq.com/miniProgram/jsSdk/jsSdkGuide/methodReverseGeocoder
- WebServiceAPI：https://lbs.qq.com/service/webService/webServiceGuide/webServiceGcoder

====================================

配置完成后即可使用！

有任何问题请参考腾讯位置服务官方文档或微信小程序开发文档。

