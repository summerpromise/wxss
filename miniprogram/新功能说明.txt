====================================
  新增功能说明 - 地址搜索与距离计算
====================================

✅ 已完成的功能：

1. 关键词输入提示
2. 真实距离计算（驾车路线）
3. 根据距离动态计算价格
4. 起点固定为用户当前位置

====================================
  功能详细说明
====================================

【功能1】关键词输入提示
------------------------
- 当用户在"目的地地址"输入框输入关键词时，自动调用腾讯地图API获取地点提示
- 提示列表实时显示在输入框下方
- 点击提示项可自动填充地址并获取坐标
- 选择地址后自动触发距离计算

实现位置：
- SDK方法：miniprogram/utils/qqmap-wx-jssdk.js -> getSuggestion()
- 页面逻辑：miniprogram/pages/index/index.js -> getSuggestions()、selectSuggestion()
- 界面展示：miniprogram/pages/index/index.wxml -> suggestions-list
- 样式：miniprogram/pages/index/index.wxss -> .suggestions-list

API接口：
- https://apis.map.qq.com/ws/place/v1/suggestion

【功能2】真实距离计算（驾车路线）
------------------------
- 使用腾讯地图距离计算API（驾车模式）
- 起点：用户当前位置的GPS坐标
- 终点：用户选择的目的地坐标
- 返回：驾车距离（米）、预计时间（秒）

实现位置：
- SDK方法：miniprogram/utils/qqmap-wx-jssdk.js -> calculateDistance()
- 页面逻辑：miniprogram/pages/index/index.js -> calculateRoute()

API接口：
- https://apis.map.qq.com/ws/distance/v1/
- 模式：driving（驾车）

【功能3】根据距离动态计算价格
------------------------
价格计算规则（符合打车行业规律）：

快车（taxi）：
- 起步价：14元（含3公里）
- 超出部分：2.6元/公里

顺风车（wind）：
- 起步价：8元（含3公里）
- 超出部分：1.8元/公里

代驾（driver）：
- 起步价：30元（含5公里）
- 超出部分：4.0元/公里

机器人（robot）：
- 起步价：5元（含2公里）
- 超出部分：1.2元/公里

无人车（autonomous）：
- 起步价：12元（含3公里）
- 超出部分：2.2元/公里

实现位置：
- miniprogram/pages/index/index.js -> calculatePrice()

【功能4】起点固定为用户当前位置
------------------------
- 起点输入框设置为只读（disabled）
- 显示用户当前位置的详细地址
- 选择服务时自动设置起点为用户当前位置
- 用户无法修改起点地址

实现位置：
- 页面逻辑：miniprogram/pages/index/index.js -> onServiceSelect()
- 界面展示：miniprogram/pages/index/index.wxml -> disabled="{{true}}"
- 样式：miniprogram/pages/index/index.wxss -> .start-address-readonly

====================================
  使用流程
====================================

1. 用户打开小程序 → 自动获取并定位到当前位置

2. 用户选择出行服务（快车/顺风车等）
   ↓
   进入地址输入页面
   ↓
   起点自动显示为用户当前位置（禁止修改）

3. 用户在"目的地地址"输入框输入关键词
   ↓
   自动显示地点提示列表
   ↓
   用户点击选择目的地

4. 自动计算驾车距离和时间
   ↓
   根据距离和车型计算价格
   ↓
   显示计算结果

5. 用户确认信息后下单

====================================
  数据流程
====================================

用户输入关键词 "天安门"
  ↓
调用 getSuggestion() API
  ↓
返回提示列表：
  - 天安门广场（北京市东城区）
  - 天安门东站（地铁站）
  - ...
  ↓
用户选择 "天安门广场"
  ↓
获取坐标：lat=39.908, lng=116.397
  ↓
调用 calculateDistance() API
  从：用户当前位置（如 lat=39.984, lng=116.308）
  到：天安门广场（lat=39.908, lng=116.397）
  模式：driving（驾车）
  ↓
返回结果：
  - 距离：15.2公里
  - 时间：25分钟
  ↓
调用 calculatePrice()
  车型：快车（taxi）
  距离：15.2公里
  ↓
计算：14 + (15.2 - 3) × 2.6 = 45.72 ≈ 46元
  ↓
显示给用户：
  距离：15.2 km
  预计时间：25 分钟
  预估价格：¥ 46

====================================
  API配额说明
====================================

腾讯地图API每日免费额度：

1. 关键词输入提示（getSuggestion）
   - 每天 10,000 次免费

2. 距离计算（calculateDistance）
   - 每天 10,000 次免费

3. 逆地理编码（reverseGeocoder）
   - 每天 10,000 次免费

说明：
- 对于个人开发者和中小型应用完全够用
- 超出免费额度后才会收费
- 可在腾讯位置服务控制台查看使用量

====================================
  注意事项
====================================

1. 必须配置服务器域名白名单：
   - https://apis.map.qq.com

2. 需要配置腾讯地图API Key：
   - 文件：miniprogram/utils/map-config.js
   - 当前已配置：2W6BZ-Z7KEW-T3BRI-YEZHB-OXGGE-ONFZR

3. 开发调试时勾选"不校验合法域名"

4. 确保Key已开通以下权限：
   - WebServiceAPI（必须）
   - 关键词输入提示
   - 距离计算
   - 逆地理编码

====================================
  测试建议
====================================

1. 测试关键词提示：
   - 输入 "天安门" 看是否显示提示列表
   - 输入 "北京" 看是否显示多个结果
   - 输入错误关键词看是否正确处理

2. 测试距离计算：
   - 选择不同距离的目的地
   - 选择不同车型查看价格差异
   - 查看Console日志确认API调用成功

3. 测试起点锁定：
   - 尝试点击起点输入框，应提示"起点为当前位置"
   - 切换不同车型，起点应始终保持为用户位置

4. 测试价格计算：
   - 3公里内应显示起步价
   - 超出起步距离应按规则计费
   - 不同车型价格应有明显差异

====================================
  常见问题
====================================

Q1: 关键词提示不显示？
A: 检查Console是否有错误，确认API Key配置正确，检查是否勾选"不校验域名"

Q2: 距离计算失败？
A: 确保终点已选择（有坐标），检查API Key权限，查看Console错误日志

Q3: 价格显示不对？
A: 检查距离是否正确计算，确认车型选择正确，查看calculatePrice方法逻辑

Q4: 起点无法修改？
A: 这是正常的，起点设计为只读，固定为用户当前位置

====================================

功能开发完成！
请重新编译小程序进行测试。

如有问题，请查看Console日志输出。
====================================

